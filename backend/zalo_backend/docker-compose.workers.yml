# docker-compose.workers.yml
#
# MVP NOTE: Separate worker containers are NOT used for MVP.
#
# Media processing workers (image optimization, video thumbnail extraction)
# run IN-PROCESS inside the main NestJS application on the same EC2 t3.medium instance.
# Bull/Redis handles job queuing in development; AWS SQS in production (see MEDIA-MODULE-PLAN.md Phase 3).
#
# This file is kept for reference. A horizontally-scaled worker deployment
# (separate containers with dedicated CPU/RAM) would use targets like:
#   docker compose -f docker-compose.yml -f docker-compose.workers.yml up
# ...but that architecture is out of scope for the current MVP budget ($200/6mo).
#
# To scale workers in the future:
#   1. Complete Phase 3 (SQS migration) in MEDIA-MODULE-PLAN.md
#   2. Restore media-worker service below, pointing to SQS queues
#   3. Remove BullModule from app.module.ts (workers become stateless SQS consumers)
#
# ----------------------------------------------------------------------------
# services:
#   media-worker:
#     build:
#       context: .
#       dockerfile: Dockerfile
#       target: worker
#     environment:
#       NODE_ENV: production
#       QUEUE_PROVIDER: sqs
#       SQS_IMAGE_QUEUE_URL: https://sqs.ap-southeast-1.amazonaws.com/...
#       SQS_VIDEO_QUEUE_URL: https://sqs.ap-southeast-1.amazonaws.com/...
#       DATABASE_URL: ...
#       AWS_REGION: ap-southeast-1
#     deploy:
#       resources:
#         limits:
#           cpus: '2.0'
#           memory: 2G


